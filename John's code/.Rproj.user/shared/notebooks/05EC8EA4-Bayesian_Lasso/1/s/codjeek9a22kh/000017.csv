"0","plot_densities <- function(ldens, cols, exclude, gold) "
"0","{"
"0","  vacc <- c()"
"0","  "
"0","  xlim <- c()"
"0","  ylim <- c()"
"0","  for (k in 1:length(ldens)) {"
"0","    if (!(k%in%exclude)) {"
"0","      xlim <- range(c(xlim,ldens[[k]]$x), finite = TRUE)"
"0","      ylim <- range(c(ylim,ldens[[k]]$y), finite = TRUE)"
"0","    }"
"0","  }"
"0","  plot(NA,type=""n"", xlim=xlim, ylim=ylim, xlab="""", ylab="""") "
"0","  for (k in 1:length(ldens)) {"
"0","    lines(ldens[[k]]$x,ldens[[k]]$y, col=cols[k], lwd=2) "
"0","    "
"0","    acc <- 1 - 0.5*trapint(ldens[[gold]]$x, abs(ldens[[gold]]$y - ldens[[k]]$y))"
"0","    vacc[k] <- acc"
"0","  }"
"0","  "
"0","  return(vacc)"
"0","}"
"0",""
"0","N <- 10000"
"0","nsd <- 5"
"0",""
"0","vmu_lm <- vbeta_lm"
"0","vsigma_lm <- summary(res_lm)$coefficients[,2]"
"0",""
"0","vmu_bem <- res_bem$vbeta"
"0","vsigma_bem <- res_bem$vse[-(p+1)]"
"0",""
"0","vmu_mfvb    <- res_mfvb$vmu_til"
"0","vsigma_mfvb <- sqrt(diag(res_mfvb$mSigma_til))"
"0",""
"0"," "
"0",""
"0","pdf(here(""figures"",paste(""lasso_densities_"",dataset_name,"".pdf"",sep="""")), width= 12, height=8)"
"0",""
"0"," "
"0",""
"0",""
"0","cols <- c(""red"", ""blue"", ""green"", ""orange"",""purple"", ""black"",""darkgray"")"
"0","exclude <- c(1,2)"
"0",""
"0","XTX <- t(mX)%*%mX"
"0","XTy <- t(mX)%*%vy"
"0",""
"0",""
"0","mai.dft <- c(1.02,0.82,0.82,0.42) #par(""mai"") # Defaults"
"0","op <- par(mai=mai.dft)"
"0","pcntB <- 0.3"
"0","pcntL <- 0.3"
"0","pcntT <- 0.3"
"0","pcntR <- 0.3"
"0","mai.new <- c(pcntB,pcntL,pcntT,pcntR) #*c(1.02,0.82,0.82,0.42)"
"0","par(mfrow=c(3,3),mai=mai.new) "
"0",""
"0","ranges <- apply( res_gibbs$mBeta[-c(1:nburn),], 2, range)"
"0",""
"0","mAcc <- matrix(0,4,p)"
"0",""
"0","for (j in 1:p) {"
"0","  "
"0","  #if (!is.nan(vsigma_bem[j])) {"
"0","  #  L <- min(c(ranges[1,j],qnorm(0.001,vmu_bem[j], vsigma_bem[j])))"
"0","  #  R <- max(c(ranges[2,j],qnorm(0.999,vmu_bem[j], vsigma_bem[j])))"
"0","  #} else {"
"0","    L <- ranges[1,j]"
"0","    R <- ranges[2,j]"
"0","  #}"
"0","  "
"0","  dens <- density(res_gibbs$mBeta[-c(1:nburn),j], from = L, to=R, n=N)"
"0","  "
"0","  xg <- dens$x"
"0","  "
"0","  ldens <- list()"
"0","  ldens[[1]] <- list(x=xg,y=dnorm(xg,vmu_bem[j], vsigma_bem[j]))"
"0","  ldens[[2]] <- list(x=xg,y=dens$y)"
"0","  ldens[[3]] <- list(x=xg,y=dnorm(xg,vmu_mfvb[j], vsigma_mfvb[j]))"
"0","  "
"0","  ldens[[4]] <-"
"0","    vb_phc_grad("
"0","      xg,"
"0","      res_mfvb$a_til,"
"0","      res_mfvb$b_til,"
"0","      res_mfvb$vmu_til,"
"0","      res_mfvb$mSigma_til,"
"0","      XTX,"
"0","      XTy,"
"0","      lambda,"
"0","      j"
"0","    )"
"0","  "
"0","  "
"0","  vacc <- plot_densities(ldens, cols, exclude, gold=2)"
"0","  "
"0","  mAcc[,j] <- vacc"
"0","  "
"0","  methods <- c(""BEM+SE"",""MCMC"", ""VB"", ""VB-PHC"")"
"0","  "
"0","  if (j==1) {"
"0","    legend(""topright"","
"0","           legend=methods,"
"0","           text.col=cols[1:7],"
"0","           border = FALSE)"
"0","  }"
"0","}"
"1","c0="
"1"," "
"1","-19.6106"
"1"," "
"1","
"
"1","c1="
"1"," "
"1","31.90594"
"1"," "
"1","
"
"1","c2="
"1"," "
"1","2.940738"
"1"," "
"1","
"
"1","c0="
"1"," "
"1","20.30979"
"1"," "
"1","
"
"1","c1="
"1"," "
"1","30.40387"
"1"," "
"1","
"
"1","c2="
"1"," "
"1","2.940738"
"1"," "
"1","
"
"1","c0="
"1"," "
"1","1.132973"
"1"," "
"1","
"
"1","c1="
"1"," "
"1","110.9576"
"1"," "
"1","
"
"1","c2="
"1"," "
"1","2.940738"
"1"," "
"1","
"
"1","c0="
"1"," "
"1","-1.124653"
"1"," "
"1","
"
"1","c1="
"1"," "
"1","50.77917"
"1"," "
"1","
"
"1","c2="
"1"," "
"1","2.940738"
"1"," "
"1","
"
"1","c0="
"1"," "
"1","0.9981265"
"1"," "
"1","
"
"1","c1="
"1"," "
"1","63.63125"
"1"," "
"1","
"
"1","c2="
"1"," "
"1","2.940738"
"1"," "
"1","
"
"1","c0="
"1"," "
"1","41.98353"
"1"," "
"1","
"
"1","c1="
"1"," "
"1","165.5895"
"1"," "
"1","
"
"1","c2="
"1"," "
"1","2.940738"
"1"," "
"1","
"
"1","c0="
"1"," "
"1","-9.38232"
"1"," "
"1","
"
"1","c1="
"1"," "
"1","74.405"
"1"," "
"1","
"
"1","c2="
"1"," "
"1","2.940738"
"1"," "
"1","
"
"1","c0="
"1"," "
"1","-2.966484"
"1"," "
"1","
"
"1","c1="
"1"," "
"1","6.269033"
"1"," "
"1","
"
"1","c2="
"1"," "
"1","2.940738"
"1"," "
"1","
"
"1","c0="
"1"," "
"1","2.419648"
"1"," "
"1","
"
"1","c1="
"1"," "
"1","5.552737"
"1"," "
"1","
"
"1","c2="
"1"," "
"1","2.940738"
"1"," "
"1","
"
"1","c0="
"1"," "
"1","6.335245"
"1"," "
"1","
"
"1","c1="
"1"," "
"1","41.32118"
"1"," "
"1","
"
"1","c2="
"1"," "
"1","2.940738"
"1"," "
"1","
"
"1","c0="
"1"," "
"1","8.294105"
"1"," "
"1","
"
"1","c1="
"1"," "
"1","10.63312"
"1"," "
"1","
"
"1","c2="
"1"," "
"1","2.940738"
"1"," "
"1","
"
"1","c0="
"1"," "
"1","5.640762"
"1"," "
"1","
"
"1","c1="
"1"," "
"1","12.4939"
"1"," "
"1","
"
"1","c2="
"1"," "
"1","2.940738"
"1"," "
"1","
"
"1","c0="
"1"," "
"1","-16.89788"
"1"," "
"1","
"
"1","c1="
"1"," "
"1","43.27261"
"1"," "
"1","
"
"1","c2="
"1"," "
"1","2.940738"
"1"," "
"1","
"
"1","c0="
"1"," "
"1","10.3682"
"1"," "
"1","
"
"1","c1="
"1"," "
"1","161.2487"
"1"," "
"1","
"
"1","c2="
"1"," "
"1","2.940738"
"1"," "
"1","
"
"1","c0="
"1"," "
"1","-71.79099"
"1"," "
"1","
"
"1","c1="
"1"," "
"1","524.6426"
"1"," "
"1","
"
"1","c2="
"1"," "
"1","2.940738"
"1"," "
"1","
"
"1","c0="
"1"," "
"1","80.37568"
"1"," "
"1","
"
"1","c1="
"1"," "
"1","457.0521"
"1"," "
"1","
"
"1","c2="
"1"," "
"1","2.940738"
"1"," "
"1","
"
"1","c0="
"1"," "
"1","19.44864"
"1"," "
"1","
"
"1","c1="
"1"," "
"1","228.2789"
"1"," "
"1","
"
"1","c2="
"1"," "
"1","2.940738"
"1"," "
"1","
"
"1","c0="
"1"," "
"1","-12.86265"
"1"," "
"1","
"
"1","c1="
"1"," "
"1","267.0861"
"1"," "
"1","
"
"1","c2="
"1"," "
"1","2.940738"
"1"," "
"1","
"
"1","c0="
"1"," "
"1","-3.152083"
"1"," "
"1","
"
"1","c1="
"1"," "
"1","159.0186"
"1"," "
"1","
"
"1","c2="
"1"," "
"1","2.940738"
"1"," "
"1","
"
